<Window x:Class="StockManager.Views.PhoneModelsWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:materialDesign="http://materialdesigninxaml.net/winfx/xaml/themes"
        Title="Modelos de celular"
        Width="760" Height="480"
        WindowStartupLocation="CenterOwner"
        FontSize="13">

    <Window.InputBindings>
        <!-- Enter = buscar -->
        <KeyBinding Key="Enter" Command="{Binding LoadCommand}" />
        <!-- Supr = eliminar (opcional) -->
        <KeyBinding Key="Delete" Command="{Binding DeleteCommand}" />
    </Window.InputBindings>

    <Grid Margin="16">
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
        </Grid.RowDefinitions>

        <!-- Top bar -->
        <DockPanel Grid.Row="0" Margin="0,0,0,12" LastChildFill="True">
            <StackPanel Orientation="Horizontal" DockPanel.Dock="Left" VerticalAlignment="Center">
                <materialDesign:PackIcon Kind="CellphoneCog" Width="22" Height="22" Margin="0,0,10,0" Opacity="0.9"/>
                <TextBlock Text="Modelos" FontSize="20" FontWeight="SemiBold" VerticalAlignment="Center"/>
            </StackPanel>

            <ToolBar DockPanel.Dock="Right" Background="Transparent" BorderThickness="0" Padding="0">

                <Button Click="New_Click"
                        Style="{DynamicResource MaterialDesignRaisedButton}"
                        Margin="0,0,8,0">
                    <StackPanel Orientation="Horizontal">
                        <materialDesign:PackIcon Kind="Plus" Width="18" Height="18" Margin="0,0,8,0"/>
                        <TextBlock Text="Nuevo"/>
                    </StackPanel>
                </Button>

                <Button Click="Edit_Click"
                        IsEnabled="{Binding HasSelection}"
                        Style="{DynamicResource MaterialDesignOutlinedButton}"
                        Margin="0,0,8,0">
                    <StackPanel Orientation="Horizontal">
                        <materialDesign:PackIcon Kind="Pencil" Width="18" Height="18" Margin="0,0,8,0"/>
                        <TextBlock Text="Editar"/>
                    </StackPanel>
                </Button>

                <Button Click="Delete_Click"
                        IsEnabled="{Binding HasSelection}"
                        Style="{DynamicResource MaterialDesignOutlinedButton}">
                    <StackPanel Orientation="Horizontal">
                        <materialDesign:PackIcon Kind="DeleteOutline" Width="18" Height="18" Margin="0,0,8,0"/>
                        <TextBlock Text="Eliminar"/>
                    </StackPanel>
                </Button>
            </ToolBar>
        </DockPanel>

        <!-- Search card -->
        <materialDesign:Card Grid.Row="1" Padding="12" Margin="0,0,0,12">
            <DockPanel LastChildFill="True">

                <Button DockPanel.Dock="Right"
                        Width="120"
                        Command="{Binding LoadCommand}"
                        Style="{DynamicResource MaterialDesignRaisedButton}">
                    <StackPanel Orientation="Horizontal">
                        <materialDesign:PackIcon Kind="Magnify" Width="18" Height="18" Margin="0,0,8,0"/>
                        <TextBlock Text="Buscar"/>
                    </StackPanel>
                </Button>

                <TextBox Margin="0,0,10,0"
                         VerticalContentAlignment="Center"
                         Text="{Binding SearchText, UpdateSourceTrigger=PropertyChanged}"
                         materialDesign:HintAssist.Hint="Buscar marca o modelo..."/>
            </DockPanel>
        </materialDesign:Card>

        <!-- Table -->
        <materialDesign:Card Grid.Row="2" Padding="0">
            <Grid>
                <DataGrid ItemsSource="{Binding Items}"
                          SelectedItem="{Binding SelectedItem}"
                          AutoGenerateColumns="False"
                          IsReadOnly="True"
                          CanUserAddRows="False"
                          HeadersVisibility="Column"
                          GridLinesVisibility="None"
                          RowHeight="34">
                    <DataGrid.Columns>
                        <DataGridTextColumn Header="Marca" Binding="{Binding Brand}" Width="1.4*"/>
                        <DataGridTextColumn Header="Modelo" Binding="{Binding ModelName}" Width="2.2*"/>
                    </DataGrid.Columns>
                </DataGrid>

                <!-- Loading overlay -->
                <Grid Background="#55FFFFFF"
                      Visibility="{Binding IsLoading, Converter={StaticResource BooleanToVisibilityConverter}}">
                    <materialDesign:Card Padding="18" HorizontalAlignment="Center" VerticalAlignment="Center">
                        <StackPanel Orientation="Horizontal">
                            <ProgressBar Width="140" Height="6" IsIndeterminate="True"/>
                            <TextBlock Text="  Cargando..." VerticalAlignment="Center" Margin="12,0,0,0"/>
                        </StackPanel>
                    </materialDesign:Card>
                </Grid>
            </Grid>
        </materialDesign:Card>

    </Grid>
</Window>
