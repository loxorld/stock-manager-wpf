<Window x:Class="StockManager.Views.DashboardWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        Title="Dashboard"
        Height="560" Width="900"
        WindowStartupLocation="CenterOwner">

    <Grid Margin="14">
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
        </Grid.RowDefinitions>

        <DockPanel Grid.Row="0" Margin="0,0,0,12" LastChildFill="True">
            <TextBlock Text="Dashboard"
                       FontSize="22"
                       FontWeight="SemiBold"
                       VerticalAlignment="Center"
                       DockPanel.Dock="Left"/>

            <Button Content="Cerrar"
                    Width="90"
                    DockPanel.Dock="Right"
                    IsCancel="True"/>
        </DockPanel>

        <!-- Period buttons -->
        <StackPanel Grid.Row="1" Orientation="Horizontal" Margin="0,0,0,12">
            <Button Content="Hoy" Width="90" Margin="0,0,8,0" Click="Today_Click"/>
            <Button Content="Semana" Width="90" Margin="0,0,8,0" Click="Week_Click"/>
            <Button Content="Mes" Width="90" Click="Month_Click"/>
        </StackPanel>
        <StackPanel Grid.Row="1" Orientation="Horizontal" Margin="0,0,0,12">
            <Button Content="Hoy" Width="90" Margin="0,0,8,0" Click="Today_Click"/>
            <Button Content="Semana" Width="90" Margin="0,0,8,0" Click="Week_Click"/>
            <Button Content="Mes" Width="90" Margin="0,0,14,0" Click="Month_Click"/>

            <Separator Width="12" Opacity="0"/>

            <TextBlock Text="Desde:" VerticalAlignment="Center" Margin="0,0,6,0"/>
            <DatePicker SelectedDate="{Binding FromDate}" Width="130" Margin="0,0,10,0"/>

            <TextBlock Text="Hasta:" VerticalAlignment="Center" Margin="0,0,6,0"/>
            <DatePicker SelectedDate="{Binding ToDate}" Width="130" Margin="0,0,10,0"/>

            <Button Content="Aplicar"
            Width="90"
            Command="{Binding ApplyRangeCommand}"/>
        </StackPanel>


        <Grid Grid.Row="2">
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="*"/>
                <ColumnDefinition Width="*"/>
            </Grid.ColumnDefinitions>
            <Grid.RowDefinitions>
                <RowDefinition Height="Auto"/>
                <RowDefinition Height="*"/>
            </Grid.RowDefinitions>

            <!-- KPIs -->
            <UniformGrid Grid.Row="0" Grid.ColumnSpan="2" Columns="3" Margin="0,0,0,12">
                <Border CornerRadius="10" BorderBrush="#20000000" BorderThickness="1" Background="#0A000000" Padding="12" Margin="0,0,10,0">
                    <StackPanel>
                        <TextBlock Text="Ingresos" Opacity="0.75"/>
                        <TextBlock Text="{Binding Revenue, StringFormat={}{0:C}}" FontSize="18" FontWeight="SemiBold"/>
                    </StackPanel>
                </Border>

                <Border CornerRadius="10" BorderBrush="#20000000" BorderThickness="1" Background="#0A000000" Padding="12" Margin="0,0,10,0">
                    <StackPanel>
                        <TextBlock Text="Unidades vendidas" Opacity="0.75"/>
                        <TextBlock Text="{Binding UnitsSold}" FontSize="18" FontWeight="SemiBold"/>
                    </StackPanel>
                </Border>

                <Border CornerRadius="10" BorderBrush="#20000000" BorderThickness="1" Background="#0A000000" Padding="12">
                    <StackPanel>
                        <TextBlock Text="Ventas (movimientos)" Opacity="0.75"/>
                        <TextBlock Text="{Binding SalesCount}" FontSize="18" FontWeight="SemiBold"/>
                    </StackPanel>
                </Border>
            </UniformGrid>

            <!-- Top by Units -->
            <Border Grid.Row="1" Grid.Column="0" CornerRadius="10" BorderBrush="#20000000" BorderThickness="1" Background="#0A000000" Padding="12" Margin="0,0,10,0">
                <StackPanel>
                    <TextBlock Text="Top 5 por unidades" FontWeight="SemiBold" Margin="0,0,0,8"/>
                    <DataGrid ItemsSource="{Binding TopByUnits}"
                              AutoGenerateColumns="False"
                              IsReadOnly="True"
                              CanUserAddRows="False"
                              HeadersVisibility="Column"
                              GridLinesVisibility="Horizontal">
                        <DataGrid.Columns>
                            <DataGridTextColumn Header="Producto" Binding="{Binding Name}" Width="*"/>
                            <DataGridTextColumn Header="Unid." Binding="{Binding Units}" Width="80"/>
                            <DataGridTextColumn Header="$" Binding="{Binding Revenue, StringFormat={}{0:C}}" Width="110"/>
                        </DataGrid.Columns>
                    </DataGrid>
                </StackPanel>
            </Border>

            <!-- Top by Revenue -->
            <Border Grid.Row="1" Grid.Column="1" CornerRadius="10" BorderBrush="#20000000" BorderThickness="1" Background="#0A000000" Padding="12">
                <StackPanel>
                    <TextBlock Text="Top 5 por ingresos" FontWeight="SemiBold" Margin="0,0,0,8"/>
                    <DataGrid ItemsSource="{Binding TopByRevenue}"
                              AutoGenerateColumns="False"
                              IsReadOnly="True"
                              CanUserAddRows="False"
                              HeadersVisibility="Column"
                              GridLinesVisibility="Horizontal">
                        <DataGrid.Columns>
                            <DataGridTextColumn Header="Producto" Binding="{Binding Name}" Width="*"/>
                            <DataGridTextColumn Header="Unid." Binding="{Binding Units}" Width="80"/>
                            <DataGridTextColumn Header="$" Binding="{Binding Revenue, StringFormat={}{0:C}}" Width="110"/>
                        </DataGrid.Columns>
                    </DataGrid>
                </StackPanel>
            </Border>

            <!-- Loading overlay -->
            <Border Grid.RowSpan="2" Grid.ColumnSpan="2"
                    Background="#80FFFFFF"
                    Visibility="{Binding IsLoading, Converter={StaticResource BooleanToVisibilityConverter}}">
                <TextBlock Text="Cargando..."
                           FontSize="18"
                           FontWeight="SemiBold"
                           HorizontalAlignment="Center"
                           VerticalAlignment="Center"/>
            </Border>

        </Grid>
    </Grid>
</Window>
